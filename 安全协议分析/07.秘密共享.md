# 目录

- 基本思想
- Shamir秘密共享
- 非对等权限秘密共享
- 秘密隐藏

# 基本思想

## **为什么要秘密共享**

- 一个秘密既要防止泄露，也要防止丢失
- 保存秘密的多个副本，可以防止秘密丢失，但增加了秘密泄露的风险
- 将秘密分割保存，单份秘密没有意义，但如果某份秘密丢失，可能导致整个秘密无法复原

## 现实生活中的例子

可口可乐的配方

据说可口可乐配方中有三种关键成分，分别被三个成员所保管，每个人都不知道其余两种成分是什么，且成员的身份也严格保密。

## 数学描述

- 一个秘密m，被分割成n份$m_1,m_2,...,m_n$,有n个节点保存，单份不会泄露m的任何信息，存在函数f,$m=f(m_1,m_2,...,m_n)$
- 更一般：一个秘密m，被分割成n份$m_1,m_2,...,m_n$，存在函数f,$m=f(m_1,m_2,...,m_n)，t<=n$,t成为**门限值**

## 简单例子

- 秘密M，随机数R
  - R由Alice保管，$M⊕R$由Bob保管
- 秘密M，随机数$R_1,R_2,...,R_{n-1}$
  - $R_1$由节点$n_1$保管，···，$R_{n-1}$由节点$n_{n-1}$保管，$M⊕R_1⊕...⊕R_{n-1}$由节点$n_n$保管
- 保险柜由三把钥匙$$$k_1,k_2,k_3$$$,由三个人保管，要求任意2人到场就可以打开
  - 张三保管$k_1,k_2$
  - 李四保管$k_2,k_3$
  - 王五保管$k_1,k_3$

## 意义

- 秘密由1个人保管，权力过于集中，风险过大
- 秘密由n个人共同保管，某个人的秘密泄露不会导致整个秘密的泄露
- 将秘密分割存储的密码技术
- 机密性：抵抗任何恶意的行为
- 强健性：对可能出现的错误的可靠性

# Shamir秘密共享

## Shamir秘密共享

- 参数：大素数p，t-1次的整系数多项式$h(x)=a_0+a_1x+...+a_{t-1}x^{t-1}\ mod \ p$
- n个人共同保管，每个人公开身份$ID_k$,隐藏$h(ID_k)$
- $a_0,...,a_{t-1}$是要保管的秘密
- 当有t个人提供自己的$(ID_k,h(ID_k))$,则可以恢复出秘密，少于t个人时则失败
- 当有t个人提供自己的$(ID_k,h(ID_k))$
  - $h(ID_1)=a_0+a_1ID_1+...+a_{t-1}ID_{t-1}\ mod\ p$
  - $h(ID_1)=a_0+a_1ID_1+...+a_{t-1}ID_{t-1}\ mod\ p$
  - ......
  - $h(ID_1)=a_0+a_1ID_1+...+a_{t-1}ID_{t-1}\ mod\ p$
- 这是t元一次方程组，可以求解$a_0,a_1...a_{t-1}$
- 当小于t个人时，方程组无法求得唯一解
- 该方案被称为$(n,t)$门限Shamir秘密共享协议

## 安全性

当t个人中存在一个恶意假冒者,其提供的$(ID_k,h(ID_k))$是错误的，则不能恢复出秘密

所以，当有多余t个人提供$(ID_k,h(ID_k))$，则需要任选t个人计算至少两次，若两次计算结果相同，则认为计算结果是正确的秘密否则参与计算的人中至少有1个恶意假冒者

# 非对等权限秘密共享

## 如果秘密共享参与者的权限并不相同

- 若公司总经理1人可以决定使用公章、两名副总共同同意可以使用公章、5名部门经理共同同意可以使用公章、1名副总3名部门经理同意可以使用公章
- 将公章使用的决策权视为秘密，如何进行共享？
- 使用（30，10)Shamir秘密共享方案：总经理拥有10份秘密，副总拥有5份秘密，部门经理拥有2份秘密。

# 秘密隐藏(阈下信道)

需求：驻外使馆与国内通信通信内容可能被所驻在国家监听

- 一种方式：使用加密，但这明确告诉监听者，这是机密信息
- 一种方式：信息隐藏，在明文中隐藏秘密信息，监听者难以判断

实现：密码协议中的秘密隐藏

## Elgamal签名中的阈下信道

消息m,随机数k,a为私钥,g为原根

$r=g^k\ mod\ p,s=(h(m)+ar)/k\ mod\ p$

秘密信息为c

要求$p=qn+1$,取k=c

收到签名r,s后，计算

$r^q\ mod\ n=(g^k)^q\ mod\ n=(g^q)^k\ mod\ n$

上述条件下的离散对数问题容易求解k，因此c=k





