本章主要内容

![](.assets/image-20211004212233756.png)

# 存储器概述

## 存储器分类

![image-20211004212313326](.assets/image-20211004212313326.png)

### 按存储介质分

#### 1、**半导体存储器**

**双极型存储器 MOS存储器**

**特点：速度快、功耗低**

#### 2、**磁存储器**

**磁芯、磁带、磁盘**

**特点：容量大，速度慢，体积大**

#### 3、**激光存储器**

**CD-ROM、CD-RW、CD-R**

**DVD-ROM、DVD-RW、DVD-R**

**特点：便于携带，廉价，易于保存**

![image-20211004212415068](.assets/image-20211004212415068.png)

### 按存取方式分

#### 1、**随机存储器**

存取时间与物理位置 无关

磁芯、半导体存储器

#### 2、**顺序存储器**

存取时间与物理位置有关

磁盘、磁带、激光存储器

#### 3、**相联存储器**

既可以按内容访问的存储器，又可以按照内容检索到存储位置进行读写

“快表”就是一种相联存储器。

![image-20211004213227384](.assets/image-20211004213227384.png)

#### 4、**直接存储器**

既有随机存取特性，也有顺序存储特性，先直接选取信息所在区域，然后按顺序方式存取。

#### 5、串行访问存储器

读写某个存储单元所需时间与存储单元的物理位置有关

![image-20211004212511455](.assets/image-20211004212511455.png)

### 按读/写功能分

#### 只读存储器（ROM）

存储器内容是预置的，固定的，无法改写的

#### 读／写存储器

既能读出也能写入的存储器

随机存储器**RAM**

![image-20211004214112198](.assets/image-20211004214112198.png)

### 按信息的可保存性分

#### 易失性存储器（Volatile Memories）

断电后信息消失

静态RAM（SRAM）

动态RAM（DRAM）

#### 非易失性存储器（Non-Volatile Memories）

断电后仍能保存信息

磁存储器、激光存储器、NVRAM

![image-20211004214101419](.assets/image-20211004214101419.png)

### 按在计算机系统中的作用分

#### 主存储器

#### 辅助存储器

#### 高速缓冲存储器 Cache

#### 控制存储器

![image-20211004214137670](.assets/image-20211004214137670.png)

![image-20211004214225027](.assets/image-20211004214225027.png)

### 存储器分类小结

![image-20211004214311343](.assets/image-20211004214311343.png)

## 冯诺依曼结构

![image-20211004214355749](.assets/image-20211004214355749.png)

## 存储系统层次结构

![image-20211004214505765](.assets/image-20211004214505765.png)

### 存在的问题

#### 速度

#### 容量

#### 价格

![image-20211004214534018](.assets/image-20211004214534018.png)

**主存增速与CPU增速不同步**

**指令执行期间多次访问存储器**

![image-20211004214614046](.assets/image-20211004214614046.png)

### 层次结构

![image-20211004214731651](.assets/image-20211004214731651.png)

![image-20211004214828514](.assets/image-20211004214828514.png)

![image-20211004214842653](.assets/image-20211004214842653.png)

## 局部性原理

### 时间局部性

现在访问的信息在不就的将来还将再次被访问；

时间局部性的程序结构体现：**循环结构**

### 空间局部性

现访问的信息2，下一次访问2附近的信息。

空间局部性的程序结构体现：顺序结构

### 例子

![image-20211004215331409](.assets/image-20211004215331409.png)

![image-20211004215348765](.assets/image-20211004215348765.png)

![image-20211004215402616](.assets/image-20211004215402616.png)

## 存储系统的主要指标

### 存储时间

接收到读写命令到从存储器中读出或写入信息所经历的时间

### 存储周期

连续两次访问存储器所需要的最小时间间隔

### 存储器带宽

单位时间内存储器存取的信息量

Byte/s



![image-20211004215814432](.assets/image-20211004215814432.png)

# 主存储器

## 基本概念

![image-20211004220104045](.assets/image-20211004220104045.png)

## 基本术语

![image-20211004220131283](.assets/image-20211004220131283.png)

## 主存储器特征

- 由半导体MOS存储器组成
- 存储单元：字存储单元，字节存储单元
- 按地址进行访问：字地址，字节地址
- 属于随机访问存储器
- 主存空间包含读/写存储空间内和只读存储空间

## 译码器

输入为数字量（即地址），根据输入的数字量在多个输出端中选一个有效

![image-20211004220458568](.assets/image-20211004220458568.png)

## 主存的基本结构和工作原理

![image-20211004220525358](.assets/image-20211004220525358.png)

## 主存中的数据组织

### 一、存储字长

- 主存的一个存储单元所包含的二进制的位数；
- 目前大多数计算机的主存按字节编址，存储字长也不断加大，如16位字长、32位字长和64位字长；
- ISA设计时要考虑的两个问题： 
- - a)如何根据字节地址读取一个32位的字？---**字的存放问题**
  - b)一个字能否存放在主存的任何字节边界》---**字的边界对齐问题**

### 二、数据存储与边界的关系

#### 1、按边界对齐的数据存储

![image-20211004221059171](.assets/image-20211004221059171.png)

#### 2、未按边界对齐的数据存储

![image-20211004221147185](.assets/image-20211004221147185.png)

#### 3、边界对齐与存储地址的关系（以32位为例）

![image-20211004221223630](.assets/image-20211004221223630.png)

![image-20211004221418930](.assets/image-20211004221418930.png)

### 三、大端与小段存储方式(Big-Endian、Little-Endian)

大端：起始地址（即数据地址）存放数据的高位字节

小端：起始地址（即数据地址）存放数据的低位字节

![image-20211004221533078](.assets/image-20211004221533078.png)

#### 例子

![image-20211004221803649](.assets/image-20211004221803649.png)

# 主存储器和CPU的连接

## 半导体存储器的设计

![img](.assets/FpDU4N7SwkOUoKkpWX_bBidEEBke.png)

## 半导体存储器的逻辑设计

![img](.assets/FkAX4LuM9EKXLW2MutyUjcq0nuHE.png)

## 主存储器与CPU的连接



![img](.assets/FveewiHLj20t4RXEuFZc1EWRX5p0.png)

### 存储器扩展

![img](.assets/FssUhOLA6Qqd_FD0CQK_MnkENVrS.png)

256K*8表示含义：256K个存储单元，每个单元是1位

![img](.assets/FtHhS0w-OfCxG5Q2cFloCwqbOE2z.png)

256K=2^18 bit 18根地址线

### 例子：

#### 位扩展

![img](.assets/FhlecECifOjC6b_9caNfg7Fdk0cK.png)

并行连接，同一地址信号，不同芯片输出不同数据

#### 字扩展

![image-20211011104814934](.assets/image-20211011104814934.png)

片选信号(CS)选择哪一个存储单元

全译码器

部分译码

![image-20211011104902015](.assets/image-20211011104902015.png)

### 各芯片地址范围

![image-20211011105048422](.assets/image-20211011105048422.png)

### 综合扩展

![image-20211011105459151](.assets/image-20211011105459151.png)

![image-20211011105741987](.assets/image-20211011105741987.png)

![image-20211011110129236](.assets/image-20211011110129236.png)

![image-20211011110538073](.assets/image-20211011110538073.png)

![image-20211011111323525](.assets/image-20211011111323525.png)

![image-20211011111340785](.assets/image-20211011111340785.png)

# 高速存储器解决之道

![image-20211011112431852](.assets/image-20211011112431852.png)

## 双端口存储器

![image-20211011112704838](.assets/image-20211011112704838.png)

不可能达到两倍读写速度，会发生冲突

## 单体多字存储器

![image-20211011112855464](.assets/image-20211011112855464.png)

## 多体交叉存储器

![image-20211011113304333](.assets/image-20211011113304333.png)

![image-20211011113346738](.assets/image-20211011113346738.png)

![image-20211011113739949](.assets/image-20211011113739949.png)

![image-20211011114012533](.assets/image-20211011114012533.png)

![image-20211018102225943](.assets/image-20211018102225943.png)

# Cache的基本原理

## 存储系统中的Cache视图

![image-20211018102320263](.assets/image-20211018102320263.png)

![image-20211018102421321](.assets/image-20211018102421321.png)

多个字组成一个块，以块为单位进行数据交换

## Cache的工作过程

![image-20211018102742006](.assets/image-20211018102742006.png)

![image-20211018103122493](.assets/image-20211018103122493.png)

## Cache地址映射机制

![image-20211018103512753](.assets/image-20211018103512753.png)

## Cache的结构

![image-20211018103847950](.assets/image-20211018103847950.png)

![image-20211018104136840](.assets/image-20211018104136840.png)

![image-20211018104543142](.assets/image-20211018104543142.png)

## Cache的命中率

![image-20211018105101788](.assets/image-20211018105101788.png)

## 主存-Cache系统的效率

![image-20211018105246971](.assets/image-20211018105246971.png)

### 例题

![image-20211018105620478](.assets/image-20211018105620478.png)

# 相联存储器

## 相联存储器的作用

![image-20211018105659118](.assets/image-20211018105659118.png)

## 判断的基本思路

![image-20211018105751671](.assets/image-20211018105751671.png)

## 相联存储器的基本结构及工作原理

![image-20211018105821826](.assets/image-20211018105821826.png)

## 相联存储器的一种技术实现

![image-20211018105920354](.assets/image-20211018105920354.png)

# Cache地址映射与变换方法

![image-20211018110448208](.assets/image-20211018110448208.png)

## 全相联映射的工作原理

![image-20211018110519623](.assets/image-20211018110519623.png)

![image-20211018110757253](.assets/image-20211018110757253.png)

![image-20211018111002003](.assets/image-20211018111002003.png)

### 特点

![image-20211018111401682](.assets/image-20211018111401682.png)

## 直接映射的工作原理

![image-20211018111805662](.assets/image-20211018111805662.png)

![image-20211018111932956](.assets/image-20211018111932956.png)

![image-20211018112120441](.assets/image-20211018112120441.png)

### 特点

![image-20211018112457180](.assets/image-20211018112457180.png)

## 组相联映射的工作原理

![image-20211018112621408](.assets/image-20211018112621408.png)

![image-20211018113001017](.assets/image-20211018113001017.png)

![image-20211018113111723](.assets/image-20211018113111723.png)

### 特点

![image-20211018113343237](.assets/image-20211018113343237.png)

## 例题

![image-20211018113530066](.assets/image-20211018113530066.png)

![image-20211018113929843](.assets/image-20211018113929843.png)

![image-20211018114253505](.assets/image-20211018114253505-16345285749863.png)

## 例题2

![image-20211018114319378](.assets/image-20211018114319378.png)

![image-20211018114537243](.assets/image-20211018114537243.png)

![image-20211018115117967](.assets/image-20211018115117967.png)

# 替换算法

## 需要替换算法的原因

![image-20211020103617531](.assets/image-20211020103617531.png)

## 几种常见的替换算法

![image-20211020103700625](.assets/image-20211020103700625.png)

## 替换算法FIFO(先入先出)

![image-20211020103640186](.assets/image-20211020103640186.png)

## 替换算法LFU(最不经常使用)

![image-20211020104048313](.assets/image-20211020104048313.png)

## 替换算法LRU(最近最久未使用)

![image-20211020104316856](.assets/image-20211020104316856.png)

## 替换算法的抖动

![image-20211020104542934](.assets/image-20211020104542934.png)

## 替换算法的实现方式

![image-20211020104721695](.assets/image-20211020104721695.png)



# 虚拟存储器

## 虚拟存储器概述

![image-20211020104801216](.assets/image-20211020104801216.png)





![image-20211020105019429](.assets/image-20211020105019429.png)

## 虚拟存储器技术必须解决的问题

![image-20211020105608156](.assets/image-20211020105608156.png)

![image-20211020110149178](.assets/image-20211020110149178.png)

![image-20211020110749993](.assets/image-20211020110749993.png)

## 虚拟存储器地址划分

![image-20211020110921671](.assets/image-20211020110921671.png)



## 逻辑地址与物理地址的转换

![image-20211020111345867](.assets/image-20211020111345867.png)

![image-20211020111650626](.assets/image-20211020111650626.png)

# TLB(Translation Lookaside Buffer)

## 虚拟地址转换过程中存在的问题

![image-20211020111932537](.assets/image-20211020111932537.png)

![image-20211020112304524](.assets/image-20211020112304524.png)

## TLB的工作原理

![image-20211020112733336](.assets/image-20211020112733336.png)

![image-20211020112902433](.assets/image-20211020112902433.png)

![image-20211020113101504](.assets/image-20211020113101504.png)

# 虚拟存储与Cache的比较

## 相同

![image-20211025101825575](.assets/image-20211025101825575.png)

## 不同

![image-20211025102008969](.assets/image-20211025102008969.png)

# 辅助存储器

## 一、概述

![image-20211025103235241](.assets/image-20211025103235241.png)

## 二、磁记录原理和记录方式

![image-20211025103910902](.assets/image-20211025103910902.png)

## 三、硬磁盘存储器

![image-20211025104128796](.assets/image-20211025104128796.png)

![image-20211025104239710](.assets/image-20211025104239710.png)

![image-20211025104704140](.assets/image-20211025104704140.png)

![image-20211025104815685](.assets/image-20211025104815685.png)

# RAID

![image-20211025110404956](.assets/image-20211025110404956.png)

![image-20211025110521648](.assets/image-20211025110521648.png)

![image-20211025110708488](.assets/image-20211025110708488.png)

![image-20211025110935973](.assets/image-20211025110935973.png)

![image-20211025111304465](.assets/image-20211025111304465.png)

![image-20211025111514635](.assets/image-20211025111514635.png)

![image-20211025111807177](.assets/image-20211025111807177.png)



![image-20211025112310403](.assets/image-20211025112310403.png)

![image-20211025112354670](.assets/image-20211025112354670.png)

![image-20211025112550196](.assets/image-20211025112550196.png)

![image-20211025112713562](.assets/image-20211025112713562.png)

![image-20211025112738386](.assets/image-20211025112738386.png)

