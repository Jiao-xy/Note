![image-20211018135124733](.assets/image-20211018135124733.png)

# VPN基本概念

## VPN

![image-20211018135141318](.assets/image-20211018135141318.png)

## VPN工作原理

![image-20211018135516791](.assets/image-20211018135516791.png)

![image-20211021083939969](.assets/image-20211021083939969.png)



![image-20211018135906160](.assets/image-20211018135906160.png)

## VPN分类

![image-20211018140148501](.assets/image-20211018140148501.png)

# IPSec协议

## 基本概念

### 由来

![image-20211018140207161](.assets/image-20211018140207161.png)



![image-20211018140608944](.assets/image-20211018140608944.png)

### 功能

![image-20211018140624337](.assets/image-20211018140624337.png)

### 体系结构

- AH
- ESP
- IKE

![image-20211018140902824](.assets/image-20211018140902824.png)



![image-20211018140914950](.assets/image-20211018140914950.png)

## IPSec协议框架

![image-20211021090501785](.assets/image-20211021090501785.png)

### 加密算法

![image-20211021090520608](.assets/image-20211021090520608.png)

### 报文摘要算法

![image-20211021090539172](.assets/image-20211021090539172.png)

### 认证----身份识别

![image-20211021090610891](.assets/image-20211021090610891.png)

#### PSK认证

![image-20211021090625146](.assets/image-20211021090625146.png)

#### RSA数字签名认证

![image-20211021090646659](.assets/image-20211021090646659.png)

### 密钥分发协议

![image-20211021090726372](.assets/image-20211021090726372.png)

### Internet密钥交换协议

![image-20211021090805134](.assets/image-20211021090805134.png)



## 认证头(AH)&封装安全载荷(ESP)

![image-20211021084826615](.assets/image-20211021084826615.png)

### 认证头(AH)

![image-20211021084915155](.assets/image-20211021084915155.png)

![image-20211021084931573](.assets/image-20211021084931573.png)

![image-20211021084943225](.assets/image-20211021084943225.png)

![image-20211021084952066](.assets/image-20211021084952066.png)

![image-20211021084959669](.assets/image-20211021084959669.png)

### 封装安全载荷(ESP)

![image-20211021085011121](.assets/image-20211021085011121.png)

![image-20211021085018974](.assets/image-20211021085018974.png)



## Internet密钥交换协议(IKE)

![image-20211021084534838](.assets/image-20211021084534838.png)

### 发送端启动IKE过程

![image-20211021084630399](.assets/image-20211021084630399.png)

### IKE建立安全关联SA的过程

![image-20211021085100718](.assets/image-20211021085100718.png)

### IKE相关策略配置举例



![image-20211021085051200](.assets/image-20211021085051200.png)

### IKE的2个协商阶段

![image-20211021085320908](.assets/image-20211021085320908.png)

#### IKE阶段1主模式

##### 1、协商策略

![image-20211021085418364](.assets/image-20211021085418364.png)

##### 2、建立DH密钥

![image-20211021085426700](.assets/image-20211021085426700.png)

##### 3、双向身份认证

![image-20211021085432956](.assets/image-20211021085432956.png)

![image-20211021085517289](.assets/image-20211021085517289.png)

#### IKE阶段2：快速模式

![image-20211021085524660](.assets/image-20211021085524660.png)

# TLS协议

![image-20211021091132778](.assets/image-20211021091132778.png)

## TLS的产生原因和发展过程

![image-20211021091153300](.assets/image-20211021091153300.png)

## TLS协议结构

![image-20211021091304992](.assets/image-20211021091304992.png)

![image-20211021091354773](.assets/image-20211021091354773.png)

## TLS记录协议工作流程

![image-20211021091944523](.assets/image-20211021091944523.png)

## TLS记录协议报文格式

![image-20211021092300542](.assets/image-20211021092300542.png)

## TLS实例实现过程

![image-20211021092537414](.assets/image-20211021092537414.png)

![image-20211021092723908](.assets/image-20211021092723908.png)



![image-20211021092633730](.assets/image-20211021092633730.png)

![image-20211021092947836](.assets/image-20211021092947836.png)

![image-20211021093105562](.assets/image-20211021093105562.png)

# HTTPs:基于TLS的HTTP

![image-20211021093142046](.assets/image-20211021093142046.png)

## 操作过程

![image-20211021093152718](.assets/image-20211021093152718.png)

![image-20211021093337238](.assets/image-20211021093337238.png)

# PGP和S/MIME



![image-20211021094227179](.assets/image-20211021094227179.png)

## PGP发送端处理过程

![image-20211021094631304](.assets/image-20211021094631304.png)

## PGP接收端处理过程

![image-20211021094821552](.assets/image-20211021094821552.png)

## SMTP邮件格式

![image-20211021095037838](.assets/image-20211021095037838.png)

## MIME邮件格式

![image-20211021095205912](.assets/image-20211021095205912.png)

## SMTP和MIME的关系

![image-20211021095222613](.assets/image-20211021095222613.png)



![image-20211021095247652](.assets/image-20211021095247652.png)

![image-20211021095418403](.assets/image-20211021095418403.png)

# 课后题(P148手写)



![image-20211024095710443](.assets/image-20211024095710443.png)

# GRE协议

## GRE协议

![image-20211025140026642](.assets/image-20211025140026642.png)

![image-20211025140250219](.assets/image-20211025140250219.png)

![image-20211025140917365](.assets/image-20211025140917365.png)

![image-20211025140929983](.assets/image-20211025140929983.png)

## GRE VPN

![image-20211025140943894](.assets/image-20211025140943894.png)

![image-20211025141044295](.assets/image-20211025141044295.png)

![image-20211025142112444](.assets/image-20211025142112444.png)

# MPLS协议

## MPLS协议

![image-20211025142639132](.assets/image-20211025142639132.png)



![image-20211025143003297](.assets/image-20211025143003297.png)

![image-20211025143452740](.assets/image-20211025143452740.png)

## MPLS VPN

### 几个术语

![image-20211025143720407](.assets/image-20211025143720407.png)

### 工作原理

![image-20211025144053500](.assets/image-20211025144053500.png)

### 例子

![image-20211025144130931](.assets/image-20211025144130931.png)



